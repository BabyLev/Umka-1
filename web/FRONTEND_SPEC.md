# Техническое Задание (ТЗ) на Разработку Веб-интерфейса "UMKA Server"

## 1. Введение

### 1.1. Назначение документа

Настоящий документ описывает требования к разработке веб-интерфейса для бэкенд-сервиса "UMKA Server". Интерфейс предназначен для взаимодействия с API сервиса, позволяя пользователям управлять спутниками, локациями наблюдателей и выполнять расчеты параметров орбит.

### 1.2. Название сервиса

UMKA Server

### 1.3. Основные технологии

- **Фреймворк:** Vue.js 3 (Composition API)
- **Маршрутизация:** Vue Router
- **Управление состоянием:** Pinia
- **Стилизация:** Tailwind CSS
- **Язык:** TypeScript
- **Сборщик:** Vite

## 2. Общие требования

### 2.1. Дизайн и UI/UX

- **Стиль:** Современный, минималистичный, чистый.
- **Цветовая палитра:** Спокойные тона (например, оттенки синего, серого, белого) с акцентным цветом для интерактивных элементов.
- **Типографика:** Читабельные современные шрифты без засечек (например, Inter, Roboto).
- **Адаптивность:** Интерфейс должен корректно отображаться на экранах различных размеров (десктоп, планшет, мобильные устройства). Использовать возможности Tailwind CSS для адаптивной верстки.
- **Интуитивность:** Пользовательский интерфейс должен быть понятным и простым в использовании, минимизировать количество кликов для выполнения типовых задач.
- **Обратная связь:** Предусмотреть индикаторы загрузки при выполнении запросов к API, уведомления об успешных операциях и сообщения об ошибках.

### 2.2. Структура приложения

Приложение должно иметь следующую структуру:

- **Боковое меню (Sidebar):** Основной элемент навигации. Должно быть фиксированным или сворачиваемым на больших экранах и скрываться за "бургером" на мобильных.
- **Основная область контента:** Динамически изменяемая область для отображения выбранного раздела.
- **Верхняя панель (Header):** Может содержать название сервиса, возможно, кнопки для глобальных действий (если потребуются).

## 3. Функциональные требования

Интерфейс должен реализовывать взаимодействие со всеми эндпоинтами API, описанными в `readme.md`.

### 3.1. Навигация (Боковое меню)

Меню должно содержать ссылки на следующие разделы:

- **Панель управления (Dashboard):** (Опционально) Стартовая страница с обзором или быстрым доступом к основным функциям.
- **Спутники:**
    - Список спутников
    - Добавить спутник
- **Локации:**
    - Список локаций
    - Добавить локацию
- **Расчеты:**
    - Расчет координат
    - Расчет углов (азимут, элевация)
    - Расчет видимости

### 3.2. Раздел "Спутники"

#### 3.2.1. Список спутников (`GET /satellite/`, `POST /satellite/`)

- **Отображение:** Таблица или список карточек со спутниками, полученными из хранилища.
    - **Колонки/Поля:** ID, Имя, NORAD ID.
    - **Фильтрация/Поиск:** Реализовать поиск по имени, ID, NORAD ID (используя `POST /satellite/`). Поле ввода для поиска.
    - **Пагинация:** Если спутников много, предусмотреть пагинацию.
- **Действия:**
    - **Просмотр/Редактирование:** Переход на страницу/модальное окно для просмотра и редактирования данных спутника (`GET /satellite/{id}`, `PATCH /satellite/`).
    - **Удаление:** Кнопка для удаления спутника (`DELETE /satellite/{id}`) с подтверждением действия.
    - **Переход к расчетам:** Возможность быстро перейти к расчетам для выбранного спутника.

#### 3.2.2. Добавление/Редактирование спутника (`PUT /satellite/`, `PATCH /satellite/`)

- **Форма:** Форма для ввода/изменения данных спутника.
    - **Поля:** Имя (обязательно), NORAD ID (опционально), Line1, Line2 (обязательны, если нет NORAD ID).
    - **Логика:**
        - При вводе NORAD ID и сохранении (для добавления или редактирования), поля Line1, Line2 и Имя должны автоматически запрашиваться с сервера (`api.r4uab.ru` через бэкенд) и подставляться/обновляться. Поля Line1/Line2 должны становиться неактивными для редактирования, если указан NORAD ID.
        - Если NORAD ID не указан, поля Line1 и Line2 обязательны для ввода.
    - **Валидация:** Проверка заполнения обязательных полей, корректности формата данных (если применимо).
    - **Сохранение:** Кнопка "Сохранить"/"Добавить". При редактировании используется `PATCH /satellite/`, при добавлении - `PUT /satellite/`.

### 3.3. Раздел "Локации"

#### 3.3.1. Список локаций (`POST /location/`)

- **Отображение:** Таблица или список карточек с локациями наблюдателей.
    - **Колонки/Поля:** ID, Имя, Долгота, Широта, Высота.
    - **Поиск:** Реализовать поиск по имени (`POST /location/`).
- **Действия:**
    - **Редактирование:** Переход на страницу/модальное окно для редактирования данных локации (`PATCH /location/`).
    - **Удаление:** Кнопка для удаления локации (`DELETE /location/{id}`) с подтверждением действия.
    - **Переход к расчетам:** Возможность быстро выбрать локацию для использования в расчетах.

#### 3.3.2. Добавление/Редактирование локации (`PUT /location/`, `PATCH /location/`)

- **Форма:** Форма для ввода/изменения данных локации.
    - **Поля:** Имя (обязательно), Долгота (обязательно), Широта (обязательно), Высота (обязательно).
    - **Валидация:** Проверка заполнения обязательных полей, проверка числовых значений координат и высоты.
    - **Сохранение:** Кнопка "Сохранить"/"Добавить". При редактировании используется `PATCH /location/`, при добавлении - `PUT /location/`.

### 3.4. Раздел "Расчеты"

#### 3.4.1. Расчет координат (`POST /calculate/`)

- **Форма:**
    - Выбор спутника: Выпадающий список или поиск для выбора спутника из сохраненных (`GET /satellite/`).
    - Временная метка (Timestamp): Поле для ввода Unix timestamp (секунды). Опционально, по умолчанию - текущее время. Возможно, добавить компонент выбора даты/времени.
    - Кнопка "Рассчитать".
- **Результат:**
    - Отображение рассчитанных значений: Широта, Долгота, Высота.
    - Отображение ссылки на Google Maps (`gmapslink`). Ссылка должна быть кликабельной.

#### 3.4.2. Расчет углов (`POST /look-angles/`)

- **Форма:**
    - Выбор спутника: Аналогично п. 3.4.1.
    - Выбор локации наблюдателя: Выпадающий список или поиск для выбора сохраненной локации (`POST /location/`).
    - Временная метка (Timestamp): Аналогично п. 3.4.1.
    - Кнопка "Рассчитать".
- **Результат:**
    - Отображение рассчитанных значений: Азимут, Элевация, Расстояние.

#### 3.4.3. Расчет видимости (`POST /time-ranges/`)

- **Форма:**
    - Выбор спутника: Аналогично п. 3.4.1.
    - Начальная временная метка (Timestamp): Поле для ввода Unix timestamp (секунды) для начала поиска. Опционально, по умолчанию - текущее время. Возможно, добавить компонент выбора даты/времени.
    - Ввод координат наблюдателя: Поля для ввода Долготы, Широты, Высоты.
    - *ИЛИ* Выбор сохраненной локации наблюдателя: Альтернативный способ задания координат наблюдателя (нужно уточнить, поддерживает ли API передачу ID локации вместо координат напрямую - *судя по документации, нет, только lon/lat/alt*). Если API не поддерживает ID, то при выборе локации ее координаты должны подставляться в поля ввода.
    - Количество интервалов: Поле для ввода числа искомых интервалов (опционально, по умолчанию 1).
    - Кнопка "Рассчитать".
- **Результат:**
    - Отображение списка интервалов видимости. Каждый интервал содержит время начала и конца в формате RFC3339. Форматировать даты для удобного чтения.

## 4. Нефункциональные требования

- **Производительность:** Интерфейс должен быть отзывчивым. Запросы к API не должны блокировать UI (использовать асинхронные операции).
- **Обработка ошибок:** Корректно обрабатывать ошибки от API (например, 4xx, 5xx коды) и отображать понятные сообщения пользователю.
- **Безопасность:** Не хранить чувствительные данные в клиентском коде или локальном хранилище без необходимости.
- **Тестирование:** (Опционально) Покрытие основного функционала модульными или интеграционными тестами.

## 5. Компоненты UI (Предварительный список)

- `AppLayout.vue`: Основной макет с Sidebar и областью контента.
- `Sidebar.vue`: Компонент бокового меню.
- `SatelliteList.vue`: Компонент для отображения списка спутников.
- `SatelliteForm.vue`: Компонент формы добавления/редактирования спутника.
- `LocationList.vue`: Компонент для отображения списка локаций.
- `LocationForm.vue`: Компонент формы добавления/редактирования локации.
- `CalculationCoordinates.vue`: Компонент для формы и результатов расчета координат.
- `CalculationLookAngles.vue`: Компонент для формы и результатов расчета углов.
- `CalculationVisibility.vue`: Компонент для формы и результатов расчета видимости.
- `BaseInput.vue`, `BaseButton.vue`, `BaseTable.vue`, `BaseModal.vue`, `BaseSpinner.vue`, `BaseNotification.vue`: Переиспользуемые UI-компоненты.

## 6. Управление состоянием (Pinia)

Предполагается использование отдельных хранилищ (stores) для:

- `satelliteStore`: Хранение списка спутников, текущего редактируемого спутника, выполнение операций CRUD для спутников.
- `locationStore`: Хранение списка локаций, текущей редактируемой локации, выполнение операций CRUD для локаций.
- `calculationStore`: Выполнение запросов для различных расчетов и хранение их результатов.
- `uiStore`: (Опционально) Хранение состояния UI (например, состояние загрузки, видимость модальных окон, уведомления).

## 7. Маршрутизация (Vue Router)

Определить маршруты для каждого раздела и подраздела, указанного в п. 3.1.

- `/`: Dashboard (если будет) или редирект на `/satellites`
- `/satellites`: Список спутников
- `/satellites/new`: Форма добавления спутника
- `/satellites/:id`: Форма редактирования спутника (или просмотр с возможностью редактирования)
- `/locations`: Список локаций
- `/locations/new`: Форма добавления локации
- `/locations/:id`: Форма редактирования локации
- `/calculations/coordinates`: Страница расчета координат
- `/calculations/look-angles`: Страница расчета углов
- `/calculations/visibility`: Страница расчета видимости

## 8. Технический долг

- **uiStore:** Раздел 6 ТЗ предполагает опциональное создание `uiStore` для состояния UI. На данный момент решено не создавать его, т.к. базовые состояния загрузки/ошибок реализованы в `satelliteStore`, `locationStore` и `calculationStore`. Если управление состоянием UI (уведомления, модальные окна и т.д.) усложнится, может потребоваться рефакторинг с выделением `uiStore`.
